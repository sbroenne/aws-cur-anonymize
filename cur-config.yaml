# AWS CUR Anonymization Configuration
# Purpose: Prepare AWS Cost & Usage Report data for cross-cloud pricing comparison (AWS â†’ Azure/Google)
#
# This config excludes only sensitive/unnecessary columns while keeping everything else:
# - Usage quantities, service details, resource specs, and public pricing
# - Filters out identity columns, internal metadata, and customer-specific pricing

# Column Exclusion: Remove only these columns from output (keep everything else)
exclude_patterns:

  - identity_*                        # Identity: Remove AWS internal identity tracking columns
  - bill_*                            # Billing: Remove invoice-specific billing details
  - payer_account_id                  # Account ID: Remove payer account
  - payer_account_name                # Account name: Remove payer account name
  - linked_account_id                 # Account ID: Remove linked account
  - linked_account_name               # Account name: Remove linked account name
  - "*_account_id"                    # Account IDs: Remove all other account ID columns
  - "*_account_name"                  # Account names: Remove all other account name columns
  - "*_resource_id"                   # ARNs: Remove Amazon Resource Names (contain account IDs)
  - "*_arn"                           # ARNs: Remove all ARN columns
  - reservation_*                     # Reservations: Remove RI-specific pricing (customer-specific rates)
  - savings_plan_*                    # Savings Plans: Remove SP-specific details (customer-specific rates)
  - discount_*                        # Discounts: Remove negotiated/promotional discounts (customer-specific)
  - line_item_unblended_cost          # Cost: Remove actual costs paid (customer-specific)
  - line_item_unblended_rate          # Cost: Remove actual rates paid (customer-specific)
  - line_item_blended_cost            # Cost: Remove blended costs (customer-specific)
  - line_item_blended_rate            # Cost: Remove blended rates (customer-specific)
  - line_item_net_unblended_cost      # Cost: Remove after-discount costs (customer-specific)
  - line_item_net_unblended_rate      # Cost: Remove after-discount rates (customer-specific)
  - credits                           # Invoice Credits: Remove credit-specific details
  - invoice_i_d                       # Invoice ID: Remove invoice identifier
  - taxation_address                  # Invoice: Remove customer taxation address
  - tax_type                          # Inovice: Remove tax type information
  - tax_amount                        # Inovice: Remove tax amount (customer-specific)
  - cost_before_tax                   # Inovice: Remove pre-tax costs (customer-specific pricing)
  - total_cost                        # Inovice: Cost: Remove final invoice amounts (customer-specific)

# Anonymization: Hash sensitive data columns that remain in output (after exclusions applied)
# Business rule: These columns MUST be anonymized if they appear in the output
anonymization:
  anonymization_patterns:
    - payer_account_id                # Must anonymize if not excluded
    - payer_account_name              # Must anonymize if not excluded
    - linked_account_id               # Must anonymize if not excluded
    - linked_account_name             # Must anonymize if not excluded
    - "*_account_id"                  # Must anonymize all account IDs if not excluded
    - "*_account_name"                # Must anonymize all account names if not excluded
    - "*_resource_id"                 # Must anonymize resources if not excluded
    - "*_arn"                         # Must anonymize ARNs if not excluded

# Row Filtering: Keep only actual resource usage rows
# Filters out fees, taxes, credits, and other non-usage line items
row_filters:
  line_item_line_item_type:
    - Usage                           # Regular on-demand usage
    - SavingsPlanCoveredUsage         # Usage covered by Savings Plans
    - DiscountedUsage                 # Usage covered by Reserved Instances
  # Filtered out: RIFee, Fee, Tax, Credit, SavingsPlanNegation, SavingsPlanRecurringFee

  record_type:
    - LineItem                        # Individual line items for resource usage
    - PayerLineItem                   # Payer-level line items
    - LinkedLineItem                  # Linked account line items (main usage records)
  # Filtered out: InvoiceTotal, StatementTotal, AccountTotal, CBRounding (summary records)
